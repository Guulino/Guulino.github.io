<!DOCTYPE html>
<html>
<head>
    <title>every image</title>
    <style>
        body {
            margin: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: #000;
            color: white;
            font-family: Arial, sans-serif;
        }
        canvas {
            border: 1px solid #333;
            margin: 20px;
            image-rendering: pixelated;
        }
        .controls {
            display: flex;
            gap: 20px;
            align-items: center;
            margin: 20px;
        }
        label {
            margin-right: 10px;
        }
        #datetime {
            color: white;
            font-family: Arial, sans-serif;
            margin: 20px;
        }
    </style>
</head>
<body>
    <canvas id="pixelCanvas" width="100" height="100" style="flex: auto;"></canvas>
    <div id="datetime"></div>
    <div id="description">
    </div>
    <script>
        const canvas = document.getElementById('pixelCanvas');
        const ctx = canvas.getContext('2d');
        const datetimeDisplay = document.getElementById('datetime');
        
        ctx.imageSmoothingEnabled = false;
        ctx.fillStyle = 'black';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        let imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        let data = imageData.data;
        
        // Cosmic time initialization (13.8 billion years in milliseconds)
        const ageOfUniverseYears = 13800000000n; // 13.8 billion years
        const millisecondsPerYear = 31557600000n; // 1 year = 31,557,600,000 ms
        const ageOfUniverseMs = ageOfUniverseYears * millisecondsPerYear;
        const baseSteps = (ageOfUniverseMs * 24n) / 1000n;
        const currentSteps = (BigInt(Date.now()) * 24n) / 1000n;
        let remainingSteps = baseSteps + currentSteps;
        let totalStepsFromStart = remainingSteps;
        
        const totalPixels = canvas.width * canvas.height;
        const pixels = [];
        
        // Initialize pixels based on cosmic time
        for (let i = 0; i < totalPixels; i++) {
            if (remainingSteps > 0n) {
                const remainder = remainingSteps % 0x1000000n;
                const rem = Number(remainder);
                pixels.push({
                    r: (rem >> 16) & 0xFF,
                    g: (rem >> 8) & 0xFF,
                    b: rem & 0xFF
                });
                remainingSteps = remainingSteps / 0x1000000n;
            } else {
                pixels.push({ r: 0, g: 0, b: 0 });
            }
        }
        
        // Initial render
        function updatePixelDisplay(index) {
            const pixel = pixels[index];
            const idx = index * 4;
            data[idx] = pixel.r;
            data[idx + 1] = pixel.g;
            data[idx + 2] = pixel.b;
            data[idx + 3] = 255;
        }
        
        for (let j = 0; j < pixels.length; j++) {
            updatePixelDisplay(j);
        }
        ctx.putImageData(imageData, 0, 0);
        
        let isPaused = false;
        let stepCounter = 0n;

        function formatNumber(n) {
            if (n < 1000) return n.toString();
            return n.toExponential(2);
        }

        function updateDateTime() {
            // Use current real time
            const now = new Date();
            
            // Calculate frames based on milliseconds (0-23 for 24fps simulation)
            const frames = Math.floor((now.getMilliseconds() / 1000) * 24);
            
            const seconds = now.getSeconds();
            const minutes = now.getMinutes();
            const hours = now.getHours();
            const day = now.getDate();
            const month = now.getMonth() + 1; // getMonth() returns 0-11
            const year = now.getFullYear();
            
            // Format the datetime string:
            const ff = frames.toString().padStart(2, '0');
            const ss = seconds.toString().padStart(2, '0');
            const mm = minutes.toString().padStart(2, '0');
            const hh = hours.toString().padStart(2, '0');
            const dd = day.toString().padStart(2, '0');
            const MM = month.toString().padStart(2, '0');
            const yyyy = year.toString();
            
            datetimeDisplay.textContent = `${yyyy}/${MM}/${dd} ${hh}:${mm}:${ss}:${ff}`;
        }

        function incrementFirstPixel() {
            const pixel = pixels[0];
            pixel.r++;
            if (pixel.r > 255) {
                pixel.r = 0;
                pixel.b++;
                if (pixel.b > 255) {
                    pixel.b = 0;
                    pixel.g++;
                    if (pixel.g > 255) {
                        pixel.r = 0;
                        pixel.g = 0;
                        pixel.b = 0;
                        return true;
                    }
                }
            }
            return false;
        }

        function incrementNextPixel(index) {
            if (index >= pixels.length) return false;
            
            const pixel = pixels[index];
            pixel.r++;
            if (pixel.r > 255) {
                pixel.r = 0;
                pixel.b++;
                if (pixel.b > 255) {
                    pixel.b = 0;
                    pixel.g++;
                    if (pixel.g > 255) {
                        pixel.r = 0;
                        pixel.g = 0;
                        pixel.b = 0;
                        return incrementNextPixel(index + 1);
                    }
                }
            }
            return false;
        }

        function updatePixels() {
            if (isPaused) return;
            
            for (let i = 0; i < 24; i++) {
                const needCarry = incrementFirstPixel();
                if (needCarry) incrementNextPixel(1);
                stepCounter++;
            }
            
            for (let j = 0; j < pixels.length; j++) {
                updatePixelDisplay(j);
            }
            
            ctx.putImageData(imageData, 0, 0);
            
            updateDateTime();
            
            const firstPixel = pixels[0];
        }

        // Initial datetime display
        updateDateTime();
        
        function animate() {
            updatePixels();
            requestAnimationFrame(animate);
        }
        
        animate();
    </script>
</body>
</html>